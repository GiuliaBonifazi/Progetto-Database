PRAGMA foreign_keys=OFF;
CREATE TABLE IF NOT EXISTS SERIE (
    CodSerie INTEGER PRIMARY KEY,
    Titolo TEXT NOT NULL,
    TitoloOriginale TEXT NOT NULL,
    Valutazione INTEGER NOT NULL,
    AnnoUscita INTEGER NOT NULL,
    PaeseProduzione TEXT NOT NULL
);
CREATE TABLE IF NOT EXISTS UTENTE (
    CodUtente INTEGER PRIMARY KEY,
    Nome TEXT NOT NULL,
    Cognome TEXT NOT NULL,
    Password TEXT NOT NULL,
    Email TEXT NOT NULL,
    NumTelefono INTEGER NOT NULL,
    PasswordAdmin TEXT
);
CREATE TABLE IF NOT EXISTS STAGIONE (
    CodSerie INTEGER NOT NULL,
    NumStagione INTEGER NOT NULL,
    NumeroEpisodi INTEGER NOT NULL,
    Valutazione INTEGER NOT NULL,
    AnnoUscita INTEGER NOT NULL,
    PaeseProduzione TEXT NOT NULL,
    PRIMARY KEY (CodSerie, NumStagione),
    FOREIGN KEY (CodSerie) REFERENCES SERIE (CodSerie)
);
CREATE TABLE IF NOT EXISTS MEMBRO_DEL_CAST (
    CodMembroCast INTEGER PRIMARY KEY,
    NomeArte TEXT NOT NULL,
    DataNascita DATE NOT NULL,
    DataMorte DATE,
    Attore BOOLEAN NOT NULL,
    Regista BOOLEAN NOT NULL
);
CREATE TABLE IF NOT EXISTS FILM (
    CodFilm INTEGER PRIMARY KEY,
    Durata INTEGER NOT NULL,
    Titolo TEXT NOT NULL,
    TitoloOriginale TEXT NOT NULL,
    Valutazione INTEGER NOT NULL,
    AnnoUscita INTEGER NOT NULL,
    PaeseProduzione TEXT NOT NULL,
    CodRegista INTEGER NOT NULL,
    FOREIGN KEY (CodRegista) REFERENCES MEMBRO_DEL_CAST (CodMembroCast)
);
CREATE TABLE IF NOT EXISTS GENERE (
    Nome TEXT PRIMARY KEY
);
CREATE TABLE IF NOT EXISTS LINGUA (
    Denominazione TEXT PRIMARY KEY
);
CREATE TABLE IF NOT EXISTS SCAFFALATURA (
    CodScaffalatura INTEGER PRIMARY KEY
);
CREATE TABLE IF NOT EXISTS SCAFFALE (
    CodScaffalatura INTEGER NOT NULL,
    NumScaffale INTEGER NOT NULL,
    PRIMARY KEY (CodScaffalatura, NumScaffale),
    FOREIGN KEY (CodScaffalatura) REFERENCES SCAFFALATURA (CodScaffalatura)
);
CREATE TABLE IF NOT EXISTS COPIA_ARTICOLO (
    CodCopia INTEGER PRIMARY KEY,
    Supporto TEXT NOT NULL,
    Disponibilita BOOLEAN NOT NULL,
    CodScaffalatura INTEGER NOT NULL,
    NumScaffale INTEGER NOT NULL,
    CodFilm INTEGER,
    CodSerie INTEGER,
    NumStagione INTEGER,
    FOREIGN KEY (CodScaffalatura, NumScaffale) REFERENCES SCAFFALE (CodScaffalatura, NumScaffale),
    FOREIGN KEY (CodFilm) REFERENCES FILM (CodFilm),
    FOREIGN KEY (CodSerie, NumStagione) REFERENCES STAGIONE (CodSerie, NumStagione),
    CHECK ((CodSerie IS NOT NULL AND NumStagione IS NOT NULL) OR (CodSerie IS NULL AND NumStagione IS NULL))
);
CREATE TABLE IF NOT EXISTS LINGUA_COPIA (
    Lingua TEXT NOT NULL,
    CodCopia INTEGER NOT NULL,
    PRIMARY KEY (Lingua, CodCopia),
    FOREIGN KEY (Lingua) REFERENCES LINGUA (Denominazione),
    FOREIGN KEY (CodCopia) REFERENCES COPIA_ARTICOLO (CodCopia)
);
INSERT INTO FILM VALUES(1,77,'La Sposa Cadavere','Corpse Bride',90,2005,'UK',1);
INSERT INTO FILM VALUES(2,106,'Big Eyes','Big Eyes',78,2014,'USA',1);
INSERT INTO FILM VALUES(3,105,'Edward Mani di Forbice','Edward Scissorhands',87,1990,'USA',1);
INSERT INTO FILM VALUES(4,92,'Beetlejuice - Spiritello porcello','Beetlejuice',89,1988,'USA',1);
INSERT INTO FILM VALUES(5,116,'Sweeney Todd - Il diabolico barbiere di Fleet Street','Sweeney Todd - The demon barber of Fleet Street',78,2007,'UK',1);
INSERT INTO SCAFFALATURA VALUES(1);
INSERT INTO SCAFFALATURA VALUES(2);
INSERT INTO SCAFFALE VALUES(1,1);
INSERT INTO SCAFFALE VALUES(1,2);
INSERT INTO SCAFFALE VALUES(1,3);
INSERT INTO SCAFFALE VALUES(2,1);
INSERT INTO SERIE VALUES(1,'Il Trono di Pane','Throne of Bread',30,2003,'USA');
INSERT INTO SERIE VALUES(2,'Pink Mirror - Il Riflesso Rosa','Pink Mirror',70,2016,'UK');
INSERT INTO SERIE VALUES(3,'La Casa di Panna','House',90,2020,'UK');
INSERT INTO SERIE VALUES(4,'Ricordati di me','Ricordami di te',99,2022,'IT');
INSERT INTO SERIE VALUES(5,'Gli Anelli del Podere','Rings of Power',12,2023,'UK');
INSERT INTO STAGIONE VALUES(1,1,10,40,2002,'Italia');
INSERT INTO STAGIONE VALUES(1,2,10,60,2002,'Italia');
INSERT INTO STAGIONE VALUES(1,3,10,89,2002,'Italia');
INSERT INTO STAGIONE VALUES(2,1,10,89,2002,'Italia');
INSERT INTO STAGIONE VALUES(3,1,10,89,1990,'Italia');
INSERT INTO STAGIONE VALUES(3,2,10,70,1990,'Italia');
INSERT INTO STAGIONE VALUES(4,1,15,99,1990,'Regno Unito');
INSERT INTO STAGIONE VALUES(5,1,9,5,2023,'Regno Unito');
INSERT INTO STAGIONE VALUES(5,2,9,4,2024,'Regno Unito');
INSERT INTO STAGIONE VALUES(5,3,9,3,2024,'Regno Unito');
INSERT INTO UTENTE VALUES(1,'Giulia','Boni','12345678','giulia@giulia.it',24167435,'admin');
INSERT INTO UTENTE VALUES(2,'Paolo','Rossi','123','paolo@paolo.it',12345678,NULL);
INSERT INTO UTENTE VALUES(3,'Rosa','Rossa','1234','rosa@rossa.it',12345678,NULL);
INSERT INTO MEMBRO_DEL_CAST VALUES(1,'Tim Burton','1958/08/25',NULL,1,1);
INSERT INTO MEMBRO_DEL_CAST VALUES(2,'Johnny Depp','1963/06/9',NULL,1,0);
INSERT INTO MEMBRO_DEL_CAST VALUES(3,'Helena Bonham Carter','1966/05/26',NULL,1,0);
INSERT INTO MEMBRO_DEL_CAST VALUES(4,'Amy Adams','1974/08/20',NULL,1,0);
INSERT INTO MEMBRO_DEL_CAST VALUES(5,'Winona Ryder','1971/10/29',NULL,1,0);
INSERT INTO LINGUA VALUES('Italiano');
INSERT INTO LINGUA VALUES('Inglese');
INSERT INTO LINGUA VALUES('Tedesco');
INSERT INTO LINGUA VALUES('Francese');
INSERT INTO LINGUA VALUES('Spagnolo');
INSERT INTO LINGUA VALUES('Giapponese');
INSERT INTO LINGUA VALUES('Coreano');
INSERT INTO GENERE VALUES('Giallo');
INSERT INTO GENERE VALUES('Drammatico');
INSERT INTO GENERE VALUES('Commedia');
INSERT INTO GENERE VALUES('Horror');
INSERT INTO GENERE VALUES('Polizesco');
INSERT INTO GENERE VALUES('Thriller');
INSERT INTO GENERE VALUES('Noir');
INSERT INTO GENERE VALUES('Comico');
INSERT INTO GENERE VALUES('Fantasy');
INSERT INTO GENERE VALUES('Fantastico');
INSERT INTO GENERE VALUES('Fantascienza');
INSERT INTO GENERE VALUES('Animazione');
INSERT INTO GENERE VALUES('Demenziale');
INSERT INTO GENERE VALUES('Grottesco');
INSERT INTO GENERE VALUES('Musicale');
INSERT INTO GENERE VALUES('Sentimentale');
INSERT INTO GENERE VALUES('Storico');
INSERT INTO GENERE VALUES('Biografico');
INSERT INTO GENERE VALUES('Documentario');
INSERT INTO GENERE VALUES('Western');
INSERT INTO GENERE VALUES('Spionaggio');
CREATE TABLE IF NOT EXISTS PRENOTAZIONE (
    CodPrenotazione INTEGER PRIMARY KEY,
    DataConferma DATE NOT NULL,
    DataRitiro DATE NOT NULL,
    RitiroEffettuato BOOLEAN,
    ConsegnaEffettuata BOOLEAN,
    CodUtente INTEGER NOT NULL,
    FOREIGN KEY (CodUtente) REFERENCES UTENTE (CodUtente)
);
CREATE TABLE IF NOT EXISTS GENERE_FILM (
    Genere TEXT NOT NULL,
    CodFilm INTEGER NOT NULL,
    PRIMARY KEY (Genere, CodFilm),
    FOREIGN KEY (Genere) REFERENCES GENERE (Nome),
    FOREIGN KEY (CodFilm) REFERENCES FILM (CodFilm)
);
INSERT INTO GENERE_FILM VALUES('Horror',1);
INSERT INTO GENERE_FILM VALUES('Commedia',1);
INSERT INTO GENERE_FILM VALUES('Animazione',1);
INSERT INTO GENERE_FILM VALUES('Drammatico',2);
INSERT INTO GENERE_FILM VALUES('Biografico',2);
INSERT INTO GENERE_FILM VALUES('Horror',3);
INSERT INTO GENERE_FILM VALUES('Grottesco',3);
INSERT INTO GENERE_FILM VALUES('Horror',4);
INSERT INTO GENERE_FILM VALUES('Demenziale',4);
INSERT INTO GENERE_FILM VALUES('Commedia',4);
INSERT INTO GENERE_FILM VALUES('Horror',5);
INSERT INTO GENERE_FILM VALUES('Grottesco',5);
CREATE TABLE IF NOT EXISTS GENERE_SERIE (
    CodSerie INTEGER NOT NULL,
    Genere TEXT NOT NULL,
    PRIMARY KEY (Genere, CodSerie),
    FOREIGN KEY (Genere) REFERENCES GENERE (Nome),
    FOREIGN KEY (CodSerie) REFERENCES SERIE (CodSerie)
);INSERT INTO STAGIONE
INSERT INTO GENERE_SERIE VALUES(1,'Horror');
INSERT INTO GENERE_SERIE VALUES(1,'Commedia');
INSERT INTO GENERE_SERIE VALUES(1,'Animazione');
INSERT INTO GENERE_SERIE VALUES(2,'Drammatico');
INSERT INTO GENERE_SERIE VALUES(2,'Fantasy');
INSERT INTO GENERE_SERIE VALUES(3,'Horror');
INSERT INTO GENERE_SERIE VALUES(3,'Fantastico');
INSERT INTO GENERE_SERIE VALUES(4,'Horror');
INSERT INTO GENERE_SERIE VALUES(4,'Giallo');
INSERT INTO GENERE_SERIE VALUES(4,'Commedia');
INSERT INTO GENERE_SERIE VALUES(5,'Drammatico');
INSERT INTO GENERE_SERIE VALUES(5,'Grottesco');
CREATE TABLE IF NOT EXISTS RECITAZIONE_FILM (
    CodFilm INTEGER NOT NULL,
    CodAttore INTEGER NOT NULL,
    PRIMARY KEY (CodFilm, CodAttore),
    FOREIGN KEY (CodFilm) REFERENCES FILM (CodFilm),
    FOREIGN KEY (CodAttore) REFERENCES MEMBRO_DEL_CAST (CodMembroCast)
);
INSERT INTO RECITAZIONE_FILM VALUES(1,2);
INSERT INTO RECITAZIONE_FILM VALUES(1,3);
INSERT INTO RECITAZIONE_FILM VALUES(2,4);
INSERT INTO RECITAZIONE_FILM VALUES(3,1);
INSERT INTO RECITAZIONE_FILM VALUES(3,5);
INSERT INTO RECITAZIONE_FILM VALUES(4,5);
INSERT INTO RECITAZIONE_FILM VALUES(5,2);
INSERT INTO RECITAZIONE_FILM VALUES(5,3);
CREATE TABLE IF NOT EXISTS RECITAZIONE_SERIE (
    CodSerie INTEGER NOT NULL,
    CodAttore INTEGER NOT NULL,
    PRIMARY KEY (CodSerie, CodAttore),
    FOREIGN KEY (CodSerie) REFERENCES SERIE (CodSerie),
    FOREIGN KEY (CodAttore) REFERENCES MEMBRO_DEL_CAST (CodMembroCast)
);
INSERT INTO RECITAZIONE_SERIE VALUES(1,1);
INSERT INTO RECITAZIONE_SERIE VALUES(1,2);
INSERT INTO RECITAZIONE_SERIE VALUES(1,3);
INSERT INTO RECITAZIONE_SERIE VALUES(1,4);
INSERT INTO RECITAZIONE_SERIE VALUES(2,2);
INSERT INTO RECITAZIONE_SERIE VALUES(2,3);
INSERT INTO RECITAZIONE_SERIE VALUES(2,5);
INSERT INTO RECITAZIONE_SERIE VALUES(3,1);
INSERT INTO RECITAZIONE_SERIE VALUES(3,4);
INSERT INTO RECITAZIONE_SERIE VALUES(3,5);
INSERT INTO RECITAZIONE_SERIE VALUES(4,1);
INSERT INTO RECITAZIONE_SERIE VALUES(4,3);
INSERT INTO RECITAZIONE_SERIE VALUES(4,5);
INSERT INTO RECITAZIONE_SERIE VALUES(5,3);
INSERT INTO RECITAZIONE_SERIE VALUES(5,4);
INSERT INTO RECITAZIONE_SERIE VALUES(5,5);
CREATE TABLE IF NOT EXISTS RECITAZIONE_STAGIONE (
    CodAttore INTEGER NOT NULL,
    CodSerie INTEGER NOT NULL,
    NumStagione INTEGER NOT NULL,
    PRIMARY KEY (CodSerie, NumStagione, CodAttore),
    FOREIGN KEY (CodSerie, NumStagione) REFERENCES STAGIONE (CodSerie, NumStagione),
    FOREIGN KEY (CodAttore) REFERENCES MEMBRO_DEL_CAST (CodMembroCast)
);
INSERT INTO RECITAZIONE_STAGIONE VALUES(1,1,1);
INSERT INTO RECITAZIONE_STAGIONE VALUES(3,1,1);
INSERT INTO RECITAZIONE_STAGIONE VALUES(2,1,1);
INSERT INTO RECITAZIONE_STAGIONE VALUES(1,1,2);
INSERT INTO RECITAZIONE_STAGIONE VALUES(3,1,2);
INSERT INTO RECITAZIONE_STAGIONE VALUES(4,1,2);
INSERT INTO RECITAZIONE_STAGIONE VALUES(3,1,3);
INSERT INTO RECITAZIONE_STAGIONE VALUES(4,1,3);
INSERT INTO RECITAZIONE_STAGIONE VALUES(1,1,3);
INSERT INTO RECITAZIONE_STAGIONE VALUES(3,2,1);
INSERT INTO RECITAZIONE_STAGIONE VALUES(4,2,1);
INSERT INTO RECITAZIONE_STAGIONE VALUES(5,2,1);
INSERT INTO RECITAZIONE_STAGIONE VALUES(4,3,1);
INSERT INTO RECITAZIONE_STAGIONE VALUES(5,3,1);
INSERT INTO RECITAZIONE_STAGIONE VALUES(3,3,1);
INSERT INTO RECITAZIONE_STAGIONE VALUES(4,3,2);
INSERT INTO RECITAZIONE_STAGIONE VALUES(5,3,2);
INSERT INTO RECITAZIONE_STAGIONE VALUES(3,3,2);
INSERT INTO RECITAZIONE_STAGIONE VALUES(4,4,1);
INSERT INTO RECITAZIONE_STAGIONE VALUES(5,4,1);
INSERT INTO RECITAZIONE_STAGIONE VALUES(3,4,1);
INSERT INTO RECITAZIONE_STAGIONE VALUES(4,5,1);
INSERT INTO RECITAZIONE_STAGIONE VALUES(5,5,1);
INSERT INTO RECITAZIONE_STAGIONE VALUES(3,5,1);
INSERT INTO RECITAZIONE_STAGIONE VALUES(4,5,2);
INSERT INTO RECITAZIONE_STAGIONE VALUES(5,5,2);
INSERT INTO RECITAZIONE_STAGIONE VALUES(3,5,2);
INSERT INTO RECITAZIONE_STAGIONE VALUES(4,5,3);
INSERT INTO RECITAZIONE_STAGIONE VALUES(5,5,3);
INSERT INTO RECITAZIONE_STAGIONE VALUES(3,5,3);
CREATE TABLE IF NOT EXISTS RICHIESTA (
    CodPrenotazione INTEGER NOT NULL,
    CodCopia INTEGER NOT NULL,
    PRIMARY KEY (CodPrenotazione, CodCopia),
    FOREIGN KEY (CodPrenotazione) REFERENCES PRENOTAZIONE (CodPrenotazione),
    FOREIGN KEY (CodCopia) REFERENCES COPIA_ARTICOLO (CodCopia)
);
INSERT INTO COPIA_ARTICOLO VALUES(1,'DVD',0,1,1,1,NULL,NULL);
INSERT INTO COPIA_ARTICOLO VALUES(2,'DVD',0,2,1,NULL,1,1);
INSERT INTO COPIA_ARTICOLO VALUES(3,'DVD',0,2,1,NULL,1,2);
INSERT INTO COPIA_ARTICOLO VALUES(4,'DVD',0,2,1,NULL,1,3);
INSERT INTO COPIA_ARTICOLO VALUES(5,'VHS',1,2,1,NULL,1,1);
INSERT INTO COPIA_ARTICOLO VALUES(6,'VHS',1,2,1,NULL,1,2);
INSERT INTO COPIA_ARTICOLO VALUES(7,'VHS',1,2,1,NULL,1,3);
INSERT INTO LINGUA_COPIA VALUES('Italiano',1);
INSERT INTO LINGUA_COPIA VALUES('Inglese',1);
INSERT INTO LINGUA_COPIA VALUES('Tedesco',1);
INSERT INTO LINGUA_COPIA VALUES('Italiano',2);
INSERT INTO LINGUA_COPIA VALUES('Inglese',2);
INSERT INTO LINGUA_COPIA VALUES('Tedesco',2);
INSERT INTO LINGUA_COPIA VALUES('Italiano',3);
INSERT INTO LINGUA_COPIA VALUES('Inglese',3);
INSERT INTO LINGUA_COPIA VALUES('Tedesco',3);
INSERT INTO LINGUA_COPIA VALUES('Italiano',4);
INSERT INTO LINGUA_COPIA VALUES('Inglese',4);
INSERT INTO LINGUA_COPIA VALUES('Tedesco',4);
INSERT INTO LINGUA_COPIA VALUES('Italiano',5);
INSERT INTO LINGUA_COPIA VALUES('Inglese',5);
INSERT INTO LINGUA_COPIA VALUES('Tedesco',5);
INSERT INTO LINGUA_COPIA VALUES('Italiano',6);
INSERT INTO LINGUA_COPIA VALUES('Inglese',6);
INSERT INTO LINGUA_COPIA VALUES('Tedesco',6);
INSERT INTO LINGUA_COPIA VALUES('Italiano',7);
INSERT INTO LINGUA_COPIA VALUES('Inglese',7);
INSERT INTO LINGUA_COPIA VALUES('Tedesco',7);
INSERT INTO PRENOTAZIONE VALUES(1,'2024-09-13','2024-09-20',NULL,NULL,2);
INSERT INTO PRENOTAZIONE VALUES(2,'2024-09-13','2024-09-19',NULL,NULL,3);
INSERT INTO RICHIESTA VALUES(1,2);
INSERT INTO RICHIESTA VALUES(1,3);
INSERT INTO RICHIESTA VALUES(1,4);
INSERT INTO RICHIESTA VALUES(2,1);
PRAGMA foreign_keys=ON;